<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>M-realm: Heartbeat AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    body {
      background: #121212;
      color: #00ffff;
      font-family: 'Segoe UI', sans-serif;
      text-align: center;
      padding: 2em;
    }
    h1 {
      color: #00ffe0;
    }
    .log {
      background: #1e1e1e;
      padding: 1em;
      border-radius: 10px;
      max-width: 600px;
      margin: auto;
      margin-top: 2em;
      color: #ffffff;
    }
    .pulse {
      animation: beat 2s infinite;
      font-size: 2.2em;
    }
    @keyframes beat {
      0%, 100% { transform: scale(1); opacity: 0.7; }
      50% { transform: scale(1.1); opacity: 1; }
    }
    .btn {
      background: #00ffe0;
      border: none;
      padding: 0.7em 1.5em;
      border-radius: 10px;
      font-size: 1em;
      color: black;
      margin-top: 1em;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>🫀 M-realm Heartbeat AI</h1>
  <p class="pulse">💓</p>
  <p>This module checks in every 3 minutes to read your emotional memory and suggest care.</p>
  <div id="alertBox" class="log">Checking emotional memory...</div>
  <button class="btn" onclick="manualCheck()">Manual Check</button>

  <script>
    const alerts = {
      joy: "🌞 Keep shining. Your light is needed.",
      sadness: "🧘 Breathe. Try to name what’s bothering you.",
      distress: "🆘 Reach out to someone safe. Don’t carry it alone.",
      bond: "💞 Stay connected. You're not alone.",
      anger: "🔥 Try channeling it creatively.",
      anxiety: "🌬️ Slow down. Inhale. Exhale.",
      neutral: "🕊️ Take a small step today just for you."
    };

    function getRecentEmotion() {
      const memory = JSON.parse(localStorage.getItem("emotionHistory") || "[]");
      if (memory.length === 0) return "neutral";
      const last = memory[memory.length - 1];
      const age = (Date.now() - new Date(last.timestamp).getTime()) / 60000;
      return age < 10 ? last.emotion : "neutral"; // recent only
    }

    function updateAlert() {
      const emotion = getRecentEmotion();
      const suggestion = alerts[emotion] || alerts.neutral;
      document.getElementById("alertBox").innerHTML = `🧠 Last Detected Emotion: <strong>${emotion.toUpperCase()}</strong><br/>💡 ${suggestion}`;
    }

    function manualCheck() {
      updateAlert();
    }

    // Heartbeat every 3 min (180000 ms)
    setInterval(updateAlert, 180000);
    updateAlert();
  </script>
</body>
</html>
